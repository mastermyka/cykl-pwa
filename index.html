<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TwÃ³j Cykl - Asystent Kobiecy</title>
<link rel="manifest" href="manifest.json">

<!-- iOS PWA ikona -->
<link rel="apple-touch-icon" sizes="512x512" href="icon-512.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
:root {
  --bg: #fafafa; --text: #333; --card: #fff;
  --accent: #ff6f61; --accent2: #ff8a80;
}
[data-theme='dark'] {
  --bg: #121212; --text: #f5f5f5; --card: #1e1e1e;
  --accent: #ff6f61; --accent2: #ff8a80;
}
body {
  font-family:'Helvetica Neue',Arial,sans-serif; margin:0;
  background: var(--bg); color: var(--text);
  transition: background .3s, color .3s;
}
header {
  background: linear-gradient(90deg,#ff7a7a,#ff5e62);
  color: white; padding: 1.5rem; text-align: center;
  position: relative;
}
.theme-toggle {
  position: absolute; right: 1rem; top: 1rem;
  background: rgba(255,255,255,0.2); border: none;
  border-radius: 50%; width: 36px; height: 36px;
  color: white; font-size: 18px; cursor: pointer;
}
.container { padding:1rem; max-width:600px; margin:auto; }
.card {
  background: var(--card); border-radius:16px;
  box-shadow:0 2px 8px rgba(0,0,0,0.1);
  padding:1rem; margin-bottom:1rem;
  transition: background .3s;
}
.phase { padding:1rem; border-radius:12px; color:white; font-weight:bold; text-align:center; }
.menstruacja{background:#ff4d6d;} .folikularna{background:#6fcf97;}
.owulacja{background:#56ccf2;} .lutealna{background:#bb6bd9;}
button {
  padding:0.7rem 1.2rem;margin-top:1rem;background:var(--accent);
  color:white;border:none;border-radius:10px;cursor:pointer;width:100%;font-weight:bold;
}
button:hover { background: var(--accent2); }
input,select,textarea {
  padding:0.5rem;width:100%;border-radius:8px;border:1px solid #ddd;margin-top:0.25rem;
}
table{width:100%;border-collapse:collapse;margin-top:0.5rem;}
th,td{padding:0.5rem;border:1px solid #ddd;text-align:center;}
th{background:#f0f0f0;}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-top:1rem;}
.day{padding:8px;border-radius:8px;text-align:center;font-size:0.85rem;cursor:pointer;}
.menstruacja-day{background:#ff4d6d;color:white;} .folikularna-day{background:#6fcf97;color:white;}
.owulacja-day{background:#56ccf2;color:white;} .lutealna-day{background:#bb6bd9;color:white;}
.quote{font-style:italic;text-align:center;color:#666;margin-top:0.5rem;}
.widget{background:var(--card);border-left:5px solid var(--accent);padding:0.75rem;border-radius:10px;margin-bottom:1rem;}
</style>
</head>
<body>
<header>
<h1>TwÃ³j Cykl â€“ Asystent Kobiecy</h1>
<button class="theme-toggle" onclick="toggleTheme()">ðŸŒ—</button>
</header>

<div class="container">

<!-- Cytat i rada dnia -->
<div class="widget">
  <h3>ðŸ’¬ Cytat dnia</h3>
  <p id="dailyQuote" class="quote"></p>
</div>
<div class="widget">
  <h3>ðŸŒ¿ Dzisiejsza rada</h3>
  <p id="dailyTip"></p>
</div>

<!-- Faza -->
<div class="card">
<h2>Aktualna faza cyklu</h2>
<div id="currentPhase" class="phase"></div>
<p><strong>DzieÅ„ cyklu:</strong> <span id="cycleDay"></span></p>
<p><strong>Owulacja:</strong> <span id="ovulationDate"></span></p>
<p><strong>Dni pÅ‚odne:</strong> <span id="fertileDays"></span></p>
<p><strong>NastÄ™pny okres:</strong> <span id="nextPeriod"></span></p>
</div>

<!-- Rekomendacje -->
<div class="card tips">
<h2>Rekomendacje</h2>
<p><strong>Å»ywienie:</strong></p><ul id="foodList"></ul>
<p><strong>Trening:</strong></p><ul id="exerciseList"></ul>
<p><strong>Samopoczucie:</strong> <span id="mood"></span></p>
</div>

<!-- Kalendarz -->
<div class="card">
<h2>Kalendarz ostatniego cyklu</h2>
<div id="calendar" class="calendar"></div>
</div>

<!-- Analiza -->
<div class="card">
<h2>Analiza cyklu</h2>
<p>Åšrednia dÅ‚ugoÅ›Ä‡ cyklu: <span id="avgCycle"></span> dni</p>
<p>Åšrednia dÅ‚ugoÅ›Ä‡ krwawienia: <span id="avgBleeding"></span> dni</p>
<p>RegularnoÅ›Ä‡: <span id="cycleVariation"></span></p>
</div>

<!-- Dziennik -->
<div class="card">
<h2>Dziennik samopoczucia</h2>
<label for="moodSelect">NastrÃ³j:</label>
<select id="moodSelect">
  <option value="">Wybierz nastrÃ³j</option>
  <option>ðŸ˜Š SzczÄ™Å›liwa</option><option>ðŸ˜´ ZmÄ™czona</option>
  <option>ðŸ˜£ DraÅ¼liwa</option><option>ðŸ˜Œ Spokojna</option><option>ðŸ¤• BÃ³l gÅ‚owy</option>
</select>
<label for="symptoms">Objawy:</label>
<textarea id="symptoms" placeholder="np. bÃ³le brzucha, sennoÅ›Ä‡..."></textarea>
<button onclick="saveMood()">Zapisz</button>
<div id="moodHistory"></div>
</div>

<!-- Historia -->
<div class="card">
<h2>Historia cykli</h2>
<table><thead><tr><th>PoczÄ…tek</th><th>Koniec</th><th>DÅ‚ugoÅ›Ä‡</th></tr></thead>
<tbody id="historyTable"></tbody></table>
</div>

<!-- Dodaj okres -->
<div class="card">
<h2>Dodaj nowy okres</h2>
<label>PoczÄ…tek:</label><input type="date" id="startDate">
<label>Koniec:</label><input type="date" id="endDate">
<button onclick="addPeriod()">Dodaj</button>
</div>
</div>

<script>
// Dane cyklu
const periods=[{start:'2025-01-07',end:'2025-01-10'},{start:'2025-01-30',end:'2025-02-02'},{start:'2025-02-24',end:'2025-02-27'},{start:'2025-03-23',end:'2025-03-26'},{start:'2025-04-16',end:'2025-04-19'},{start:'2025-05-12',end:'2025-05-15'},{start:'2025-06-04',end:'2025-06-07'},{start:'2025-06-28',end:'2025-07-01'},{start:'2025-07-24',end:'2025-07-27'},{start:'2025-08-18',end:'2025-08-21'},{start:'2025-09-12',end:'2025-09-15'},{start:'2025-10-08',end:'2025-10-11'},{start:'2025-10-30',end:'2025-11-02'},{start:'2025-11-25',end:'2025-11-28'},{start:'2025-12-19',end:'2025-12-22'}];
const tips={menstruacja:{food:['Szpinak','Buraki','Smoothie malinowe'],exercise:['Spacer','RozciÄ…ganie'],mood:'Odpocznij'},folikularna:{food:['Jajka','Owsianka','SaÅ‚atka z kurczakiem'],exercise:['SiÅ‚owy','Cardio'],mood:'Energia!'},owulacja:{food:['Owoce','Orzechy','Smoothie jagodowe'],exercise:['Taniec','Trening HIIT'],mood:'PewnoÅ›Ä‡ siebie'},lutealna:{food:['Czekolada','Banany','Magnez'],exercise:['Joga','Spacer'],mood:'Wahania nastroju'}};
const quotes=["KaÅ¼dy dzieÅ„ to nowy poczÄ…tek.","Zaufaj swojemu ciaÅ‚u.","JesteÅ› silniejsza niÅ¼ myÅ›lisz.","RÃ³wnowaga to klucz.","Twoje ciaÅ‚o zasÅ‚uguje na troskÄ™.","Nie musisz byÄ‡ produktywna, Å¼eby byÄ‡ wystarczajÄ…ca."];
const wellnessTips=["ZrÃ³b dziÅ› gÅ‚Ä™boki wdech i odpocznij ðŸŒ¿","Wypij dodatkowÄ… szklankÄ™ wody ðŸ’§","PoÅ›wiÄ™Ä‡ 10 minut na rozciÄ…ganie ðŸ§˜â€â™€ï¸","Zjedz coÅ› zielonego ðŸ¥—","PomyÅ›l o trzech rzeczach, za ktÃ³re jesteÅ› wdziÄ™czna ðŸ’–"];

// Helpery
const parseDate=s=>new Date(s+'T00:00:00');
const formatDate=d=>d.toISOString().split('T')[0];
const avgCycle=()=>Math.round(periods.slice(1).map((p,i)=>(parseDate(p.start)-parseDate(periods[i].start))/86400000).reduce((a,b)=>a+b)/ (periods.length-1));
const avgBleeding=()=>Math.round(periods.map(p=>(parseDate(p.end)-parseDate(p.start))/86400000+1).reduce((a,b)=>a+b)/periods.length);
const variation=()=>{const arr=periods.slice(1).map((p,i)=>(parseDate(p.start)-parseDate(periods[i].start))/86400000);const d=Math.max(...arr)-Math.min(...arr);return d<=2?'Regularny':'Zmienny o '+d+' dni';};

// Fazy
function getCycleInfo(){
 const avg=avgCycle();const last=parseDate(periods.at(-1).start);const today=new Date();
 const day=Math.floor((today-last)/86400000)+1;
 const ovDay=13;const fertileStart=new Date(last);fertileStart.setDate(fertileStart.getDate()+ovDay-5);
 const fertileEnd=new Date(last);fertileEnd.setDate(fertileEnd.getDate()+ovDay);
 const ovDate=new Date(last);ovDate.setDate(ovDate.getDate()+ovDay);
 const nextP=new Date(last);nextP.setDate(nextP.getDate()+avg);
 let phase='lutealna',cls='lutealna';if(day<=4){phase='menstruacja';cls='menstruacja';}else if(day<=ovDay-2){phase='folikularna';cls='folikularna';}else if(day===ovDay||day===ovDay-1){phase='owulacja';cls='owulacja';}
 return{phase,cls,day,ov:formatDate(ovDate),fert:[formatDate(fertileStart),formatDate(fertileEnd)],nextP:formatDate(nextP),tips:tips[phase]};
}

// Update UI
function updateUI(){
 const i=getCycleInfo();
 document.getElementById('currentPhase').textContent=i.phase.toUpperCase();
 document.getElementById('currentPhase').className='phase '+i.cls;
 document.getElementById('cycleDay').textContent=i.day;
 document.getElementById('ovulationDate').textContent=i.ov;
 document.getElementById('fertileDays').textContent=i.fert[0]+' â€“ '+i.fert[1];
 document.getElementById('nextPeriod').textContent=i.nextP;
 document.getElementById('avgCycle').textContent=avgCycle();
 document.getElementById('avgBleeding').textContent=avgBleeding();
 document.getElementById('cycleVariation').textContent=variation();
 document.getElementById('foodList').innerHTML=i.tips.food.map(f=>`<li>${f}</li>`).join('');
 document.getElementById('exerciseList').innerHTML=i.tips.exercise.map(e=>`<li>${e}</li>`).join('');
 document.getElementById('mood').textContent=i.tips.mood;
 updateCalendar();updateHistory();showMoodHistory();
}

// Kalendarz, historia, mood
function updateCalendar(){const c=document.getElementById('calendar');c.innerHTML='';const last=parseDate(periods.at(-1).start);const avg=avgCycle();for(let i=0;i<avg;i++){const d=new Date(last);d.setDate(d.getDate()+i);let cls='lutealna-day';if(i<4)cls='menstruacja-day';else if(i<12)cls='folikularna-day';else if(i===12||i===11)cls='owulacja-day';c.innerHTML+=`<div class='day ${cls}' onclick='alert(\"${formatDate(d)}\")'>${d.getDate()}</div>`;}}
function updateHistory(){const tb=document.getElementById('historyTable');tb.innerHTML='';periods.forEach(p=>{const len=(parseDate(p.end)-parseDate(p.start))/86400000+1;tb.innerHTML+=`<tr><td>${p.start}</td><td>${p.end}</td><td>${len}</td></tr>`;});}
function saveMood(){const m=moodSelect.value,s=symptoms.value;if(!m&&!s)return alert('WypeÅ‚nij dane');const all=JSON.parse(localStorage.getItem('moods')||'[]');all.push({date:formatDate(new Date()),mood:m,sym:s});localStorage.setItem('moods',JSON.stringify(all));moodSelect.value='';symptoms.value='';showMoodHistory();}
function showMoodHistory(){const all=JSON.parse(localStorage.getItem('moods')||'[]');moodHistory.innerHTML='<h3>Ostatnie wpisy:</h3>'+all.slice(-5).reverse().map(e=>`<p><strong>${e.date}</strong>: ${e.mood} â€“ ${e.sym}</p>`).join('');}
function addPeriod(){const s=startDate.value,e=endDate.value;if(s&&e){periods.push({start:s,end:e});updateUI();alert('Dodano!');}}

// Cytaty i rady
function showDailyQuote(){const d=new Date().toDateString();let stored=JSON.parse(localStorage.getItem('quoteDay')||'{}');if(stored.date!==d){stored={date:d,text:quotes[Math.floor(Math.random()*quotes.length)]};localStorage.setItem('quoteDay',JSON.stringify(stored));}document.getElementById('dailyQuote').textContent=stored.text;}
function showDailyTip(){const d=new Date().toDateString();let stored=JSON.parse(localStorage.getItem('tipDay')||'{}');if(stored.date!==d){stored={date:d,text:wellnessTips[Math.floor(Math.random()*wellnessTips.length)]};localStorage.setItem('tipDay',JSON.stringify(stored));}document.getElementById('dailyTip').textContent=stored.text;}

// Motyw
function toggleTheme(){const current=document.documentElement.getAttribute('data-theme');const newTheme=current==='dark'?'light':'dark';document.documentElement.setAttribute('data-theme',newTheme);localStorage.setItem('theme',newTheme);}
(function(){const userPref=localStorage.getItem('theme')||(window.matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light');document.documentElement.setAttribute('data-theme',userPref);})();

updateUI();showDailyQuote();showDailyTip();

if('serviceWorker'in navigator)navigator.serviceWorker.register('service-worker.js');
</script>
</body>
</html>
