<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tw√≥j Cykl Kobiecy - PWA</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; background:#fff; color:#333;}
  header { background:#ff8da1; color:#fff; padding:15px; text-align:center; font-size:1.5em;}
  #quote, #wellness { margin:15px; font-size:1.2em; text-align:center;}
  #calendar { display:grid; grid-template-columns:repeat(7, 1fr); gap:2px; margin:15px;}
  .day { border:1px solid #ccc; padding:10px; text-align:center; cursor:pointer; user-select:none; border-radius:5px;}
  .menstruation { background:#ffb3b3; }
  .follicular { background:#ffd9b3; }
  .ovulation { background:#b3ffc6; }
  .luteal { background:#b3d9ff; }
  /* Popup */
  #popup { position:fixed; top:0; left:0; width:100%; height:100%; display:none; background:rgba(0,0,0,0.5); justify-content:center; align-items:center; flex-direction:column; z-index:1000;}
  #popupContent { background:#fff; padding:20px; border-radius:10px; width:90%; max-width:400px; box-shadow:0 4px 8px rgba(0,0,0,0.2);}
  #popupContent h3 { margin-top:0; }
  #popupContent label { display:block; margin-top:10px; }
  #popupContent textarea { width:100%; height:60px; margin-top:5px; }
  #popupContent select { width:100%; padding:5px; margin-top:5px; }
  #popupContent button { margin-top:10px; padding:10px; width:48%; border:none; border-radius:5px; cursor:pointer; }
  #popupContent button#saveBtn { background:#4CAF50; color:#fff; }
  #popupContent button#closeBtn { background:#f44336; color:#fff; }
</style>
</head>
<body>

<header>Tw√≥j Cykl Kobiecy</header>

<div id="quote"></div>
<div id="wellness"></div>

<div id="calendar"></div>

<!-- Popup -->
<div id="popup">
  <div id="popupContent">
    <h3>Dzie≈Ñ <span id="popupDate"></span></h3>
    <div>Faza: <span id="popupPhase"></span></div>
    <label>Objawy / Samopoczucie:</label>
    <textarea id="popupNotes"></textarea>
    <label>Aktywno≈õƒá fizyczna:</label>
    <select id="popupActivity">
      <option value="">Brak</option>
      <option value="spacer">Spacer</option>
      <option value="joga">Joga / RozciƒÖganie</option>
      <option value="trening">Trening</option>
      <option value="odpoczynek">Odpoczynek</option>
    </select>
    <div style="display:flex; justify-content:space-between;">
      <button id="saveBtn">Zapisz</button>
      <button id="closeBtn">Zamknij</button>
    </div>
  </div>
</div>

<script>
// --------------------------
// Cytaty i wellness
// --------------------------
const quotes = [
"Ka≈ºdy dzie≈Ñ to nowy poczƒÖtek.",
"Zaufaj swojemu cia≈Çu ‚Äì ono wie, czego potrzebuje.",
"Jeste≈õ silniejsza, ni≈º my≈õlisz.",
"Nie musisz byƒá doskona≈Ça, ≈ºeby byƒá wystarczajƒÖca.",
"Twoje emocje sƒÖ wa≈ºne ‚Äì s≈Çuchaj ich.",
"R√≥wnowaga to klucz do spokoju.",
"Pielƒôgnuj siebie tak, jak pielƒôgnujesz innych.",
"Zmiana zaczyna siƒô od oddechu.",
"Zas≈Çugujesz na odpoczynek.",
"Twoje cia≈Ço nie jest Twoim wrogiem ‚Äì to Tw√≥j dom.",
"Ka≈ºdy cykl przynosi nowƒÖ energiƒô.",
"Czasem si≈Ça to po prostu przetrwaƒá dzie≈Ñ.",
"Zatrzymaj siƒô. Oddychaj. Wszystko jest dobrze.",
"Masz prawo do spokoju i ciszy.",
"Mi≈Ço≈õƒá do siebie to nie egoizm, to odwaga.",
"Twoje cia≈Ço jest mƒÖdre ‚Äì zaufaj mu.",
"Nie por√≥wnuj swojego rytmu do innych.",
"To, co czujesz, jest wa≈ºne.",
"Zadbaj o siebie tak, jak o ukochanƒÖ osobƒô.",
"Jeste≈õ czƒô≈õciƒÖ natury ‚Äì i tak jak ona, masz swoje pory roku.",
"Hormony to nie przeszkoda ‚Äì to Tw√≥j rytm.",
"Jutro te≈º jest dzie≈Ñ.",
"Nie b√≥j siƒô zwolniƒá tempa.",
"Twoja si≈Ça tkwi w ≈Çagodno≈õci.",
"Ka≈ºdy etap cyklu to dar, nie wyzwanie.",
"Poczuj wdziƒôczno≈õƒá za to, ≈ºe jeste≈õ.",
"Twoje cia≈Ço nie musi byƒá produktywne, ≈ºeby byƒá piƒôkne.",
"Zmienno≈õƒá to czƒô≈õƒá kobiecej natury.",
"Dzi≈õ wybieram spok√≥j.",
"Nie wszystko musisz mieƒá pod kontrolƒÖ.",
"Pozw√≥l sobie na odpoczynek ‚Äì to te≈º dzia≈Çanie.",
"Twoja warto≈õƒá nie zale≈ºy od energii, kt√≥rƒÖ dzi≈õ masz.",
"Zaufaj procesowi.",
"R√≥wnowaga to sztuka codziennych ma≈Çych decyzji.",
"Czasem cisza m√≥wi wiƒôcej ni≈º tysiƒÖc s≈Ç√≥w.",
"W Twojej delikatno≈õci jest ogromna si≈Ça.",
"Nie musisz nic udowadniaƒá.",
"Ka≈ºdy dzie≈Ñ przynosi nowƒÖ szansƒô na spok√≥j.",
"BƒÖd≈∫ dla siebie dobra.",
"Masz prawo byƒá zmƒôczona ‚Äì to czƒô≈õƒá bycia cz≈Çowiekiem.",
"Uwa≈ºno≈õƒá zmienia spos√≥b, w jaki odbierasz ≈õwiat.",
"Ka≈ºdy oddech to szansa na reset.",
"Daj sobie prawo do ma≈Çych przyjemno≈õci.",
"Twoja energia ma swoje naturalne wzloty i spadki.",
"≈ömiech to lekarstwo dla duszy.",
"Nie oceniaj siebie zbyt surowo.",
"Odpu≈õƒá to, czego nie mo≈ºesz zmieniƒá.",
"Codzienny rytua≈Ç mo≈ºe daƒá spok√≥j.",
"Twoje potrzeby sƒÖ wa≈ºne.",
"Zr√≥b co≈õ mi≈Çego dla swojego cia≈Ça.",
"Obserwuj zmiany w sobie z ciekawo≈õciƒÖ.",
"Ka≈ºdy dzie≈Ñ to nowa lekcja.",
"Cia≈Ço i umys≈Ç potrzebujƒÖ r√≥wnowagi.",
"Nie b√≥j siƒô s≈Çuchaƒá intuicji.",
"Akceptacja siebie to pierwszy krok do szczƒô≈õcia.",
"Twoja obecno≈õƒá jest wystarczajƒÖca.",
"Zas≈Çugujesz na troskƒô i uwagƒô.",
"Nie spiesz siƒô, ≈ºycie nie ucieka.",
"Ka≈ºda emocja jest dopuszczalna.",
"Nie musisz zawsze byƒá w pe≈Çni gotowa.",
"Tw√≥j rytm jest unikalny.",
"Codziennie ucz siƒô czego≈õ o sobie.",
"Twoja si≈Ça tkwi w autentyczno≈õci.",
"Pozw√≥l sobie na chwilƒô oddechu.",
"Cisza daje odpowiedzi, kt√≥rych nie daje ha≈Ças.",
"Nie musisz mieƒá planu na wszystko.",
"Doceniaj ma≈Çe kroki.",
"Zr√≥b dzi≈õ co≈õ, co sprawia Ci rado≈õƒá.",
"Twoja intuicja prowadzi Ciƒô najlepiej.",
"Nie oceniaj swojego dnia zbyt surowo.",
"Ka≈ºdy etap ≈ºycia ma swoje znaczenie.",
"Twoje cia≈Ço zas≈Çuguje na troskƒô.",
"Nie por√≥wnuj siƒô do innych kobiet.",
"Tw√≥j czas jest cenny ‚Äì dbaj o niego.",
"Nie musisz byƒá produktywna ca≈Çy czas.",
"Ma≈Çe zwyciƒôstwa te≈º sƒÖ wa≈ºne.",
"Twoje granice sƒÖ wa≈ºne.",
"Nie b√≥j siƒô prosiƒá o pomoc.",
"≈öwiadome oddechy uspokajajƒÖ umys≈Ç.",
"Zadbaj o swoje emocje tak samo jak o cia≈Ço.",
"Twoje potrzeby sƒÖ wa≈ºniejsze ni≈º opinie innych.",
"Nie spiesz siƒô, ka≈ºdy rytm ma sens.",
"Cia≈Ço i umys≈Ç potrzebujƒÖ odpoczynku.",
"Akceptacja siebie to najlepszy prezent.",
"Pozw√≥l sobie na ma≈Çe przyjemno≈õci.",
"Ka≈ºdy dzie≈Ñ to szansa na spok√≥j.",
"Twoja si≈Ça tkwi w cierpliwo≈õci.",
"Nie musisz byƒá idealna, ≈ºeby byƒá szczƒô≈õliwa.",
"Zas≈Çugujesz na troskƒô i mi≈Ço≈õƒá.",
"Twoja energia ma swoje naturalne granice.",
"Uwa≈ºno≈õƒá pozwala lepiej czuƒá cia≈Ço.",
"Ka≈ºda emocja ma prawo siƒô pojawiƒá.",
"Nie oceniaj swojego rytmu za surowo.",
"Twoja obecno≈õƒá jest wystarczajƒÖca.",
"Zaufaj procesowi swojego cia≈Ça.",
"R√≥wnowaga to codzienna praktyka.",
"Tw√≥j spok√≥j ma znaczenie.",
"Zr√≥b dzi≈õ co≈õ, co daje Ci rado≈õƒá.",
"Cia≈Ço wie lepiej ni≈º my≈õlisz.",
"Nie musisz kontrolowaƒá wszystkiego.",
"Akceptacja siebie daje wolno≈õƒá.",
"Twoja si≈Ça tkwi w delikatno≈õci.",
"Pozw√≥l sobie na odpoczynek dzisiaj.",
"Codziennie ucz siƒô czego≈õ o sobie.",
"Twoje emocje sƒÖ naturalne i wa≈ºne.",
"Nie por√≥wnuj swojego rytmu z innymi.",
"≈öwiadome chwile dajƒÖ energiƒô.",
"Ma≈Çe kroki prowadzƒÖ do wielkich zmian.",
"Twoja obecno≈õƒá jest TwojƒÖ mocƒÖ.",
"Nie oceniaj siƒô za surowo ‚Äì jeste≈õ wystarczajƒÖca.",
"Zas≈Çugujesz na spok√≥j i troskƒô."
];

const wellnessTips = [
"Wypij szklankƒô wody po przebudzeniu üíß",
"Zr√≥b 5 g≈Çƒôbokich oddech√≥w üåø",
"RozciƒÖgnij ramiona i plecy üßò‚Äç‚ôÄÔ∏è",
"Po≈õwiƒôƒá 10 minut na relaks üíï",
"Zjedz co≈õ zielonego ü•ó",
"Zr√≥b kr√≥tki spacer na ≈õwie≈ºym powietrzu üö∂‚Äç‚ôÄÔ∏è",
"Pos≈Çuchaj ulubionej muzyki üé∂",
"Zr√≥b herbatƒô i chwilƒô odpocznij ‚òï",
"Zapisz 3 rzeczy, za kt√≥re jeste≈õ wdziƒôczna ‚úçÔ∏è",
"Zr√≥b mini-meditacjƒô 5 minut ü™∑",
"Od≈Ç√≥≈º telefon na godzinƒô üìµ",
"Zr√≥b co≈õ kreatywnego üé®",
"Poƒáwicz uwa≈ºno≈õƒá przy jednej czynno≈õci üßò",
"Zadbaj o nawodnienie üí¶",
"Zjedz po≈ºywne ≈õniadanie üç≤",
"U≈õmiechnij siƒô do siebie w lustrze üôÇ",
"Wieczorem we≈∫ ciep≈ÇƒÖ kƒÖpiel üõÅ",
"Wyjd≈∫ na balkon i oddychaj g≈Çƒôboko üå§Ô∏è",
"Rozlu≈∫nij ramiona i kark üíÜ‚Äç‚ôÄÔ∏è",
"Napisz komu≈õ mi≈ÇƒÖ wiadomo≈õƒá üíå",
"Nie oceniaj siebie zbyt surowo üí´",
"Odpu≈õƒá to, czego nie mo≈ºesz zmieniƒá üå∏",
"Stw√≥rz sobie ma≈Çy rytua≈Ç spokoju üïØÔ∏è",
"Zadbaj o swoje potrzeby üß°",
"Obserwuj swoje cia≈Ço z ciekawo≈õciƒÖ üëÄ",
"Codziennie ucz siƒô czego≈õ nowego o sobie üìñ",
"Po≈õwiƒôƒá 5 minut na ≈õwiadome oddychanie üå¨Ô∏è",
"Zjedz owoce zamiast s≈Çodyczy üçé",
"Id≈∫ na kr√≥tki spacer w przerwie od pracy üö∂‚Äç‚ôÄÔ∏è",
"Zr√≥b notatkƒô o pozytywnych wydarzeniach dnia üìì",
"Zr√≥b 10 pompek lub kilka przysiad√≥w üí™",
"Zrelaksuj oczy ‚Äì patrz w dal przez minutƒô üëÅÔ∏è",
"Zr√≥b dziennik wdziƒôczno≈õci üìù",
"Zr√≥b przerwƒô od ekranu ‚Äì oczy odpocznƒÖ üëÄ",
"Zaplanuj ma≈ÇƒÖ przyjemno≈õƒá na wiecz√≥r üåô",
"Oddychaj ≈õwiadomie podczas codziennych czynno≈õci üßò‚Äç‚ôÄÔ∏è",
"Zr√≥b kr√≥tki stretching przed snem üåõ",
"Wypij ciep≈ÇƒÖ herbatƒô zio≈ÇowƒÖ üåø",
"Zr√≥b ma≈ÇƒÖ medytacjƒô wdziƒôczno≈õci üôè",
"RozciƒÖgnij szyjƒô i barki üíÜ‚Äç‚ôÄÔ∏è",
"Zjedz zdrowƒÖ przekƒÖskƒô miƒôdzy posi≈Çkami ü•ú",
"Po≈õwiƒôƒá chwilƒô na ulubionƒÖ aktywno≈õƒá fizycznƒÖ üèÉ‚Äç‚ôÄÔ∏è",
"Pos≈Çuchaj relaksujƒÖcej muzyki üéµ",
"Zr√≥b sobie maseczkƒô lub peeling twarzy üßñ‚Äç‚ôÄÔ∏è",
"U≈Ç√≥≈º porzƒÖdek na biurku lub w pokoju üßπ",
"Po≈õwiƒôƒá czas na kreatywne pisanie ‚úçÔ∏è",
"Zjedz co≈õ bogatego w witaminy üçä",
"Przypomnij sobie trzy pozytywne rzeczy z dnia üå∏",
"Wyjd≈∫ na balkon i poczuj powietrze üå¨Ô∏è",
"Zr√≥b kr√≥tkƒÖ wizualizacjƒô spokoju üßò",
"Przeznacz 10 minut na ≈õwiadome rozciƒÖganie üåø",
"Zr√≥b kr√≥tki spacer po schodach üèÉ‚Äç‚ôÄÔ∏è",
"Zapisz sw√≥j nastr√≥j w dzienniku üå∏",
"Zjedz lekki posi≈Çek przed snem üçµ",
"Zr√≥b kilka g≈Çƒôbokich oddech√≥w przed rozpoczƒôciem pracy üå¨Ô∏è",
"Po≈õwiƒôƒá chwilƒô na wyciszenie umys≈Çu üßò‚Äç‚ôÄÔ∏è",
"Zr√≥b prosty trening rozciƒÖgajƒÖcy üßé‚Äç‚ôÄÔ∏è",
"Wypij szklankƒô wody z cytrynƒÖ üçã",
"Zr√≥b kilka przysiad√≥w lub pajacyk√≥w üèãÔ∏è‚Äç‚ôÄÔ∏è",
"Po≈õwiƒôƒá czas na spokojnƒÖ lekturƒô üìñ",
"Zr√≥b kr√≥tkƒÖ medytacjƒô oddechowƒÖ üåø",
"Zrelaksuj miƒô≈õnie karku i ramion üíÜ",
"Zr√≥b kr√≥tki spacer w ciƒÖgu dnia üö∂‚Äç‚ôÄÔ∏è",
"Zjedz ≈õwie≈ºe owoce üçì",
"Po≈õwiƒôƒá chwilƒô na uwa≈ºne jedzenie ü•ó",
"Zapisz swoje my≈õli w dzienniku ‚úçÔ∏è",
"RozciƒÖgnij plecy i biodra üßò",
"Zr√≥b ma≈ÇƒÖ przerwƒô od pracy przy komputerze üíª",
"Po≈õwiƒôƒá chwilƒô na ≈õwiadomy oddech üå¨Ô∏è",
"Zjedz zdrowƒÖ przekƒÖskƒô z orzechami ü•ú",
"Zr√≥b kr√≥tkƒÖ medytacjƒô relaksacyjnƒÖ üåø",
"Po≈õwiƒôƒá czas na s≈Çuchanie ulubionej muzyki üéµ",
"Zrelaksuj miƒô≈õnie n√≥g i st√≥p ü¶∂",
"Zr√≥b kilka pompek lub plank üèãÔ∏è‚Äç‚ôÄÔ∏è",
"Zjedz lekki posi≈Çek bogaty w bia≈Çko üç≥",
"Po≈õwiƒôƒá 10 minut na spacer na ≈õwie≈ºym powietrzu üö∂",
"Zr√≥b ma≈ÇƒÖ wizualizacjƒô swojego spokoju üßò‚Äç‚ôÄÔ∏è",
"Wypij ciep≈ÇƒÖ herbatƒô zio≈ÇowƒÖ przed snem üçµ",
"RozciƒÖgnij rƒôce, barki i szyjƒô üíÜ‚Äç‚ôÄÔ∏è",
"Po≈õwiƒôƒá chwilƒô na medytacjƒô wdziƒôczno≈õci üôè",
"Zr√≥b kr√≥tkƒÖ seriƒô przysiad√≥w lub rozgrzewki üèãÔ∏è",
"Zjedz co≈õ ≈õwie≈ºego i pe≈Çnowarto≈õciowego ü•ó",
"Po≈õwiƒôƒá chwilƒô na ≈õwiadomy oddech üå¨Ô∏è",
"Zapisz swoje emocje w dzienniku ‚úçÔ∏è",
"RozciƒÖgnij nogi i plecy przed snem üßò‚Äç‚ôÄÔ∏è",
"Zr√≥b kr√≥tki spacer dla relaksu üö∂",
"Po≈õwiƒôƒá chwilƒô na s≈Çuchanie przyjemnych d≈∫wiƒôk√≥w üéµ",
"Zr√≥b ma≈ÇƒÖ aktywno≈õƒá fizycznƒÖ w ciƒÖgu dnia üèÉ‚Äç‚ôÄÔ∏è",
"Zjedz co≈õ bogatego w witaminy i minera≈Çy üçä",
"Po≈õwiƒôƒá czas na swoje hobby lub pasjƒô üé®",
"Zrelaksuj oczy i odwr√≥ƒá wzrok od ekranu üëÄ",
"Zr√≥b 5 minutowy mini-meditation üåø",
"Po≈õwiƒôƒá chwilƒô na uwa≈ºne mycie rƒÖk lub picie wody üíß",
"Zr√≥b kr√≥tkƒÖ wizualizacjƒô swojego dnia üå∏",
"RozciƒÖgnij rƒôce i barki w ciƒÖgu dnia üíÜ‚Äç‚ôÄÔ∏è",
"Po≈õwiƒôƒá czas na s≈Çuchanie muzyki, kt√≥ra uspokaja üé∂",
"Zr√≥b kr√≥tkƒÖ przerwƒô na oddech w pracy üå¨Ô∏è",
"Zjedz lekkƒÖ przekƒÖskƒô bogatƒÖ w bia≈Çko ü•ö",
"Zr√≥b kilka prostych ƒáwicze≈Ñ rozciƒÖgajƒÖcych üßò‚Äç‚ôÄÔ∏è",
"Po≈õwiƒôƒá chwilƒô na ≈õwiadome picie wody üíß",
"Zapisz 3 pozytywne my≈õli z dnia ‚úçÔ∏è",
"RozciƒÖgnij plecy i kark przed snem üõå",
"Zr√≥b kr√≥tki spacer na ≈õwie≈ºym powietrzu üö∂‚Äç‚ôÄÔ∏è",
"Po≈õwiƒôƒá chwilƒô na uwa≈ºne jedzenie ü•ó",
"Zr√≥b kilka g≈Çƒôbokich oddech√≥w i wycisz umys≈Ç üåø",
"Zrelaksuj stopy i nogi po ca≈Çym dniu üë£",
"Po≈õwiƒôƒá chwilƒô na kr√≥tkƒÖ medytacjƒô relaksacyjnƒÖ üßò",
"Zjedz co≈õ ≈õwie≈ºego i zdrowego üçé",
"Zr√≥b kr√≥tki trening rozciƒÖgajƒÖcy przed snem üèãÔ∏è‚Äç‚ôÄÔ∏è"
];


function showDailyQuote() {
  const d = new Date().toDateString();
  let stored = JSON.parse(localStorage.getItem('quoteDay') || '{}');
  if(stored.date !== d) {
    stored = { date:d, text:quotes[Math.floor(Math.random()*quotes.length)] };
    localStorage.setItem('quoteDay', JSON.stringify(stored));
  }
  document.getElementById('quote').textContent = stored.text;
}

function showDailyWellness() {
  const d = new Date().toDateString();
  let stored = JSON.parse(localStorage.getItem('wellnessDay') || '{}');
  if(stored.date !== d) {
    stored = { date:d, text:wellnessTips[Math.floor(Math.random()*wellnessTips.length)] };
    localStorage.setItem('wellnessDay', JSON.stringify(stored));
  }
  document.getElementById('wellness').textContent = stored.text;
}

showDailyQuote();
showDailyWellness();

// --------------------------
// Interaktywny kalendarz
// --------------------------
const calendarDiv = document.getElementById('calendar');

const cycleData = [
  {start:"2025-01-07", end:"2025-01-10"},
  {start:"2025-01-30", end:"2025-02-02"},
  {start:"2025-02-24", end:"2025-02-27"},
  {start:"2025-03-23", end:"2025-03-26"},
  {start:"2025-04-16", end:"2025-04-19"},
  {start:"2025-05-12", end:"2025-05-15"},
  {start:"2025-06-04", end:"2025-06-07"},
  {start:"2025-06-28", end:"2025-07-01"},
  {start:"2025-07-24", end:"2025-07-27"},
  {start:"2025-08-18", end:"2025-08-21"},
  {start:"2025-09-12", end:"2025-09-15"},
  {start:"2025-10-08", end:"2025-10-11"},
  {start:"2025-10-30", end:"2025-11-02"},
  {start:"2025-11-25", end:"2025-11-28"},
  {start:"2025-12-19", end:"2025-12-22"},
];

function getPhase(date) {
  const d = new Date(date);
  for(const c of cycleData){
    const start = new Date(c.start);
    const end = new Date(c.end);
    if(d>=start && d<=end) return {phase:"menstruation", label:"Menstruacja"};
  }
  const lastStart = new Date(cycleData[cycleData.length-1].start);
  const diff = Math.floor((d-lastStart)/86400000) % 28;
  if(diff>=0 && diff<6) return {phase:"follicular", label:"Faza folikularna"};
  if(diff>=6 && diff<14) return {phase:"ovulation", label:"Owulacja"};
  return {phase:"luteal", label:"Faza lutealna"};
}

function updateCalendar() {
  calendarDiv.innerHTML="";
  const today = new Date();
  const year = today.getFullYear();
  const month = today.getMonth();
  const firstDay = new Date(year, month,1);
  const lastDay = new Date(year, month+1,0);
  for(let i=1;i<=lastDay.getDate();i++){
    const dayDate = new Date(year,month,i);
    const phaseObj = getPhase(dayDate);
    const div = document.createElement('div');
    div.className = "day "+phaseObj.phase;
    div.textContent = i;
    div.dataset.date = dayDate.toISOString().split('T')[0];
    div.addEventListener('click',()=>openPopup(div.dataset.date));
    calendarDiv.appendChild(div);
  }
}

// --------------------------
// Popup
// --------------------------
const popup = document.getElementById('popup');
const popupDate = document.getElementById('popupDate');
const popupPhase = document.getElementById('popupPhase');
const popupNotes = document.getElementById('popupNotes');
const popupActivity = document.getElementById('popupActivity');
const saveBtn = document.getElementById('saveBtn');
const closeBtn = document.getElementById('closeBtn');

function openPopup(dateStr) {
  popup.style.display="flex";
  popupDate.textContent = dateStr;
  const phaseObj = getPhase(dateStr);
  popupPhase.textContent = phaseObj.label;
  const saved = JSON.parse(localStorage.getItem("day-"+dateStr) || "{}");
  popupNotes.value = saved.notes || "";
  popupActivity.value = saved.activity || "";
}

saveBtn.addEventListener('click',()=>{
  const dateStr = popupDate.textContent;
  const data = {notes: popupNotes.value, activity: popupActivity.value};
  localStorage.setItem("day-"+dateStr, JSON.stringify(data));
  popup.style.display="none";
});

closeBtn.addEventListener('click',()=>{ popup.style.display="none"; });

updateCalendar();
</script>
</body>
</html>
