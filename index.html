<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cykl Kobiecy - PWA</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; background:#fff; color:#333;}
  header { background:#ff8da1; color:#fff; padding:15px; text-align:center; font-size:1.5em;}
  #quote, #wellness { margin:15px; font-size:1.2em; text-align:center;}
  #calendar { display:grid; grid-template-columns:repeat(7, 1fr); gap:2px; margin:15px;}
  .day { border:1px solid #ccc; padding:10px; text-align:center; cursor:pointer; user-select:none; }
  .menstruation { background:#ffb3b3; }
  .follicular { background:#ffd9b3; }
  .ovulation { background:#b3ffc6; }
  .luteal { background:#b3d9ff; }
  /* Popup */
  #popup {
    position: fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    display:none;
    background: rgba(0,0,0,0.5);
    justify-content: center;
    align-items: center;
    flex-direction: column;
    z-index: 1000;
  }
  #popupContent {
    background:#fff;
    padding:20px;
    border-radius:10px;
    width:90%;
    max-width:400px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  }
  #popupContent h3 { margin-top:0; }
  #popupContent label { display:block; margin-top:10px; }
  #popupContent textarea { width:100%; height:60px; }
  #popupContent select { width:100%; padding:5px; }
  #popupContent button { margin-top:10px; padding:10px; width:48%; border:none; border-radius:5px; cursor:pointer; }
  #popupContent button#saveBtn { background:#4CAF50; color:#fff; }
  #popupContent button#closeBtn { background:#f44336; color:#fff; }
</style>
</head>
<body>

<header>TwÃ³j Cykl Kobiecy</header>

<div id="quote"></div>
<div id="wellness"></div>

<div id="calendar"></div>

<!-- Popup -->
<div id="popup">
  <div id="popupContent">
    <h3>DzieÅ„ <span id="popupDate"></span></h3>
    <div>Faza: <span id="popupPhase"></span></div>
    <label>Objawy / Samopoczucie:</label>
    <textarea id="popupNotes"></textarea>
    <label>AktywnoÅ›Ä‡ fizyczna:</label>
    <select id="popupActivity">
      <option value="">Brak</option>
      <option value="spacer">Spacer</option>
      <option value="joga">Joga / RozciÄ…ganie</option>
      <option value="trening">Trening</option>
      <option value="odpoczynek">Odpoczynek</option>
    </select>
    <div style="display:flex; justify-content:space-between;">
      <button id="saveBtn">Zapisz</button>
      <button id="closeBtn">Zamknij</button>
    </div>
  </div>
</div>

<script>
// --------------------------
// Cytaty i wellness
// --------------------------
const quotes = [
"KaÅ¼dy dzieÅ„ to nowy poczÄ…tek.",
"Zaufaj swojemu ciaÅ‚u â€“ ono wie, czego potrzebuje.",
"JesteÅ› silniejsza, niÅ¼ myÅ›lisz.",
"Nie musisz byÄ‡ doskonaÅ‚a, Å¼eby byÄ‡ wystarczajÄ…ca.",
"Twoje emocje sÄ… waÅ¼ne â€“ sÅ‚uchaj ich.",
"RÃ³wnowaga to klucz do spokoju.",
"PielÄ™gnuj siebie tak, jak pielÄ™gnujesz innych.",
"Zmiana zaczyna siÄ™ od oddechu.",
"ZasÅ‚ugujesz na odpoczynek.",
"Twoje ciaÅ‚o nie jest Twoim wrogiem â€“ to TwÃ³j dom.",
];

const wellnessTips = [
"Wypij szklankÄ™ wody po przebudzeniu ðŸ’§",
"ZrÃ³b 5 gÅ‚Ä™bokich oddechÃ³w ðŸŒ¿",
"RozciÄ…gnij ramiona i plecy ðŸ§˜â€â™€ï¸",
"PoÅ›wiÄ™Ä‡ 10 minut na relaks ðŸ’•",
"Zjedz coÅ› zielonego ðŸ¥—",
];

function showDailyQuote() {
  const d = new Date().toDateString();
  let stored = JSON.parse(localStorage.getItem('quoteDay') || '{}');
  if(stored.date !== d) {
    stored = { date:d, text:quotes[Math.floor(Math.random()*quotes.length)] };
    localStorage.setItem('quoteDay', JSON.stringify(stored));
  }
  document.getElementById('quote').textContent = stored.text;
}

function showDailyWellness() {
  const d = new Date().toDateString();
  let stored = JSON.parse(localStorage.getItem('wellnessDay') || '{}');
  if(stored.date !== d) {
    stored = { date:d, text:wellnessTips[Math.floor(Math.random()*wellnessTips.length)] };
    localStorage.setItem('wellnessDay', JSON.stringify(stored));
  }
  document.getElementById('wellness').textContent = stored.text;
}

showDailyQuote();
showDailyWellness();

// --------------------------
// Interaktywny kalendarz
// --------------------------
const calendarDiv = document.getElementById('calendar');

const cycleData = [
  {start:"2025-01-07", end:"2025-01-10"},
  {start:"2025-01-30", end:"2025-02-02"},
  {start:"2025-02-24", end:"2025-02-27"},
  {start:"2025-03-23", end:"2025-03-26"},
  {start:"2025-04-16", end:"2025-04-19"},
  {start:"2025-05-12", end:"2025-05-15"},
  {start:"2025-06-04", end:"2025-06-07"},
  {start:"2025-06-28", end:"2025-07-01"},
  {start:"2025-07-24", end:"2025-07-27"},
  {start:"2025-08-18", end:"2025-08-21"},
  {start:"2025-09-12", end:"2025-09-15"},
  {start:"2025-10-08", end:"2025-10-11"},
  {start:"2025-10-30", end:"2025-11-02"},
  {start:"2025-11-25", end:"2025-11-28"},
  {start:"2025-12-19", end:"2025-12-22"},
];

function getPhase(date) {
  const d = new Date(date);
  for(const c of cycleData){
    const start = new Date(c.start);
    const end = new Date(c.end);
    if(d>=start && d<=end) return {phase:"menstruation", label:"Menstruacja"};
  }
  const lastStart = new Date(cycleData[cycleData.length-1].start);
  const diff = Math.floor((d-lastStart)/86400000) % 28;
  if(diff>=0 && diff<6) return {phase:"follicular", label:"Faza folikularna"};
  if(diff>=6 && diff<14) return {phase:"ovulation", label:"Owulacja"};
  return {phase:"luteal", label:"Faza lutealna"};
}

function updateCalendar() {
  calendarDiv.innerHTML="";
  const today = new Date();
  const year = today.getFullYear();
  const month = today.getMonth();
  const firstDay = new Date(year, month,1);
  const lastDay = new Date(year, month+1,0);
  // dodajemy nagÅ‚Ã³wki dni tygodnia
  const days = ["Pn","Wt","Åšr","Cz","Pt","Sb","Nd"];
  for(let d of days){
    const headerDiv = document.createElement("div");
    headerDiv.textContent = d;
    headerDiv.style.fontWeight = "bold";
    headerDiv.style.textAlign = "center";
    calendarDiv.appendChild(headerDiv);
  }
  // puste dni na poczÄ…tku miesiÄ…ca
  const startWeekDay = (firstDay.getDay()+6)%7; // przesuniÄ™cie Pn=0
  for(let i=0;i<startWeekDay;i++){
    const emptyDiv = document.createElement("div");
    calendarDiv.appendChild(emptyDiv);
  }
  // dni miesiÄ…ca
  for(let i=1;i<=lastDay.getDate();i++){
    const dayDate = new Date(year,month,i);
    const phaseObj = getPhase(dayDate);
    const div = document.createElement('div');
    div.className = "day "+phaseObj.phase;
    div.textContent = i;
    div.dataset.date = dayDate.toISOString().split('T')[0];
    div.addEventListener('click',()=>openPopup(div.dataset.date));
    calendarDiv.appendChild(div);
  }
}

// --------------------------
// Popup
// --------------------------
const popup = document.getElementById('popup');
const popupDate = document.getElementById('popupDate');
const popupPhase = document.getElementById('popupPhase');
const popupNotes = document.getElementById('popupNotes');
const popupActivity = document.getElementById('popupActivity');
const saveBtn = document.getElementById('saveBtn');
const closeBtn = document.getElementById('closeBtn');

function openPopup(dateStr) {
  popup.style.display="flex";
  popupDate.textContent = dateStr;
  const phaseObj = getPhase(dateStr);
  popupPhase.textContent = phaseObj.label;
  const saved = JSON.parse(localStorage.getItem("day-"+dateStr)||"{}");
  popupNotes.value = saved.notes||"";
  popupActivity.value = saved.activity||"";
}

saveBtn.addEventListener('click',()=>{
  const dateStr = popupDate.textContent;
  const data = {notes: popupNotes.value, activity: popupActivity.value};
  localStorage.setItem("day-"+dateStr, JSON.stringify(data));
  popup.style.display="none";
});

closeBtn.addEventListener('click',()=>{ popup.style.display="none"; });

updateCalendar();
</script>
</body>
</html>
